---
title: 控制理论整理
top_img: /image/top3.jpg
mathjax: true
cover: /image/boat-4812434_1280.jpg
description: 控制理论笔记及理解整理
tags: 
  - 电气
  - 笔记
  - 大三
categories: 课程

post_meta:
  page:
    date_type: both # created or updated or both 主页文章日期是创建日或者更新日或都显示
    date_format: date # date/relative 显示日期还是相对日期
    categories: true # true or false 主页是否显示分类
    tags: true # true or false 主页是否显示标签
    label: true # true or false 显示描述性文字
  post:
    date_type: both # created or updated or both 文章页日期是创建日或者更新日或都显示
    date_format: date # date/relative 显示日期还是相对日期
    categories: true # true or false 文章页是否显示分类
    tags: true # true or false 文章页是否显示标签
    label: true # true or false 显示描述性文字

copyright_author: Paradox
copyright_author_href: https://github.com/ParadoxTZ
copyright_info: 此文章版权归Paradox所有，如有转载，请注明来自原作者
---

# 控制理论（乙）

* 这门课在讲什么东西？
  * 控制——将一个输入信号丢到控制系统（一个黑匣子）中，得到一个输出信号
  * 控制系统的性质、响应、稳定性，以及我们怎么去搭建控制系统
  * 是信号分析与处理的后续课程
* 下面我将分四章来进行阐述：

* 整理了PDF版本，内容跟下面差别不大，好处是可以打印而且不会出现渲染问题
  * <a href="\myfile\控制理论（乙）.pdf" target="_blank">控制理论笔记</a>

## 系统的时域分析

### 信号分析与处理基础

| 时域                              | 频域          |
| --------------------------------- | ------------- |
| $e^{-pt}$                         | $\frac1{s+p}$ |
| 单位脉冲                          | $1$           |
| 单位阶跃                          | $\frac 1s$    |
| 单位斜坡$\gamma(t)=t$             | $\frac1{s^2}$ |
| 单位加速度$\gamma(t)=\frac{t^2}2$ | $\frac1{s^3}$ |

### 梅森公式与信号流图

记：

1. $P_k$为第k条前向通道的通道增益
2. $\Delta$为特征式：$\Delta=1-(不同回路增益之和)+(每两个互不接触的回路增益乘积之和)+(每三个\dots)$
3. $\Delta_k$为去除第k条前向通道后的特征式

$$
P=\frac1{\Delta}\sum_kP_k\Delta_k
$$

### 稳态误差

#### 基本原理

* 默认单位闭环传递函数，即H(s)为1。否则其定义式有分歧。

$$
\begin{gather*}
\frac{C(s)}{R(s)}=\frac{G(s)}{1+G(s)H(s)} \\\frac{E(s)}{R(s)}=1-\frac{C(s)H(s)}{R(s)}=\frac1{1+G(s)H(s)}\\
\Rightarrow E(s)=\frac{R(s)} {1+G(s)H(s)}\,;\,e_{ss}=\text{lim}_{s\rightarrow0}\frac{sR(s)} {1+G(s)H(s)}\end{gather*}
$$

#### 公式

|                          | 0型系统                        | 1型系统                         | 2型系统                             |
| ------------------------ | ------------------------------ | ------------------------------- | ----------------------------------- |
| 静态误差系数             | 位置$K_p=\lim_{s\to0}G(s)H(s)$ | 速度$K_v=\lim_{s\to0}sG(s)H(s)$ | 加速度$K_a=\lim_{s\to0}s^2G(s)H(s)$ |
| 有常数稳态误差的输入信号 | 单位阶跃                       | 单位斜坡                        | 单位加速度                          |
| 稳态误差                 | $e_{ss}=\frac1{1+K_p}$         | $e_{ss}=\frac1{K_v}$            | $e_{ss}=\frac1{K_a}$                |

* 静态误差系数的含义：开环（或闭环）传递函数的增益，即分子的K值

### 暂态响应

| 指标 | 最大超调量$\sigma_p$                         | 延迟时间$t_d$  | 上升时间$t_r$                                                | 峰值时间$t_p$          | 调整时间$t_s$                                |
| ---- | -------------------------------------------- | -------------- | ------------------------------------------------------------ | ---------------------- | -------------------------------------------- |
| 定义 | $\frac{Max-Final}{Final}\times100\%$         | 到达稳态值一半 | 第一次到达稳态值                                             | 第一次到达峰值         | 偏差小于5%或2%                               |
| 一阶 | /                                            | /              | /                                                            | /                      | 3T或4T                                       |
| 二阶 | $\text{exp}(-\frac{\xi\pi}{\sqrt{1-\xi^2}})$ | /              | $\frac{\pi-\text{atan}\frac{\sqrt{1-\xi^2}}{\xi}}{\omega_n\sqrt{1-\xi^2}}=\frac{\pi-\beta}{\omega_d}$ | $\frac{\pi}{\omega_d}$ | $\frac3{\xi\omega_n}$或$\frac4{\xi\omega_n}$ |

* 二阶系统的传递函数为：

$$
\begin{gather*}开环:G(s)=\frac{\omega_n^2}{s(s+2\xi\omega_n)}\,;\,闭环:G(s)=\frac{\omega_n^2}{s^2+2\xi\omega_ns+\omega_n^2}\\
s_1,s_2=-\xi\omega_n\pm j\omega_n\sqrt{1-\xi^2}\triangleq \sigma\pm j\omega_d\end{gather*}
$$

* 其典型参数为：

| 参数 | $\xi$                  | $\omega_n$           | $\omega_d$                        | $\beta$                                 |
| ---- | ---------------------- | -------------------- | --------------------------------- | --------------------------------------- |
| 含义 | 阻尼比                 | 无阻尼自然振荡角频率 | 阻尼自然振荡频率                  |                                         |
| 公式 | $\xi=\text{cos}\theta$ |                      | $\omega_d=\omega_n\sqrt{1-\xi^2}$ | $\text{atan}\frac{\sqrt{1-\xi^2}}{\xi}$ |

![](\image\控制理论01.jpg)

## 系统的频域分析

### 频率响应

​		频率响应是针对正弦输入信号所做的分析。因为所有信号均可由傅里叶变换分解为若干个正弦信号之和（详见信号分析与处理的笔记），因此掌握对于不同频率的正弦信号的频率特性是系统分析的重要一环。

* 把开环（一般是闭环）传递函数$G(s)$中的变量$s$用$j\omega$代替（即虚轴），就得到了其频率特性$G(j\omega)$
* 频率特性可以直接反应对正弦信号的稳态响应：$c(t)=A|G(j\omega)|\cdot\text{sin}(\omega t+\varphi)$，其中：
  * $G(j\omega)=|G(j\omega)|e^{j\varphi(\omega)}$

#### 极坐标图

以$\sigma$作为横轴，$j\omega$作为纵轴，画出$G(j\omega)$随着ω从0变化到$+\infty$时的曲线

* 一般将其表示为$G(j\omega)=|G(j\omega)|e^{j\varphi(\omega)}$的形式，分别找到幅值和相角随着ω变化的规律
  * **幅值：**当ω=0时，0型系统在常数位置的定点，1型、2型系统在无穷远点；当ω=$\infty$时，一般而言都在0点。
  * **相角：**对于分子m次，分母n次的$\nu$型系统，$\varphi(0)=-90°\nu\,\,;\,\,\varphi(+\infty)=90°(m-n)$
* ω<0的部分与ω>0的部分沿实轴对称
* 当ω=0的地方在无穷远点时，从0-出发顺时针绕一个半径为无穷大的圆（半圆）回到0+

### 对数坐标图

注意我们一般把传递函数写成$G(s)=\frac{1+T_1s}{s^{\nu}(1+T_2s)}$的形式，但是其分界点是$\omega_i=\frac1{T_1}$，或者可以写成$G(j\omega)=\frac1{1+j\frac{\omega}{\omega_0}}$这样

| 典型环节 | 表达式         | 图                         | 特点                                                         |
| -------- | -------------- | -------------------------- | ------------------------------------------------------------ |
| 一阶惯性 | $\frac1{Ts+1}$ | ![](\image\控制理论05.png) | 在$\frac1T$后以20dB/dec下降，<br />相角渐变-90°，$\frac1T$时为-45° |
| 积分     | $\frac1s$      | ![](\image\控制理论06.png) | 一直以20dB/dec下降，相角全局 -90°                            |
| 微分     | $s$            | ![](\image\控制理论07.png) | 一直以20dB/dec上升，相角全局+90°                             |

#### 对数坐标图的性质

1. 在伯德图的最后段，斜率为$k=-(n-m)\text{dB/dec}$，相角为$\varphi=-90°(n-m)$
2. 对于0型系统：低频段水平，高度$20\text{lg}K_p$
3. 对于1型系统：低频段斜率$-20\text{dB/dec}$；转折点$\omega=1$，高度$20\text{lg}K_v$；**延长线交点$(K_v,0)$**
4. 对于2型系统：低频段斜率$-40\text{dB/dec}$；转折点$\omega=1$，高度$20\text{lg}K_a$；**延长线交点$(\sqrt{K_a},0)$**

## 系统稳定的四种判定

劳斯判据、根轨迹、奈氏图、伯德图+余量

下面用一道题来演示一下（求该**闭环系统**稳定的时候K的取值范围）：
$$
G(s)=\frac{K(1-s)(1+10s)}{s^2(1+2s)}
$$

### 劳斯判据

| 原理                                                         | 演示                                                         |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| $\begin{gather*}s^n&a_0&a_2&a_4&\dots\\s^{n-1}&a_1&a_3&a_5&\dots\\s^{n-2}&\frac{x_{i+1}y_1-x_1y_{i+1}}{y_1}&\dots\\\vdots&\vdots\\s^0&z_1   \end{gather*}$ | $2s^3+(1-10K)s^2+9Ks+K=0$<br />$\begin{gather*}  s^3&2&9K\\s^{2}&(1-10K)&K\\s&\frac{K(7-90K)}{1-10K} \\s^0&K\end{gather*}$ |

$$
\begin{gather*}\Rightarrow K>0,1-10K>0,7-90K>0\\0<K<\frac7{90}\end{gather*}
$$

### 根轨迹图

根轨迹作图法的8条规则（1.2条合起来）：

1. 连续性、对称性（实轴）
2. 根轨迹条数=最高阶次，起点=开环极点，终点=开环零点（或无穷远）
3. 实轴上右侧零极点数目之和为奇数的位置有根轨迹
4. 渐近线：起点$\sigma=\frac{\Sigma(-p)-\Sigma(-z)}{n-m}$，倾角$\alpha=\frac{\pm(2k+1)\pi}{n-m}$
5. 分离点和汇合点：$\frac{\text dK}{\text ds}=0$
6. 出射角$\varphi_p=\mp(2k+1)\pi+\sum\lambda_i-\Sigma\Lambda_i$，入射角反一下。其中$\lambda$是零点，$\Lambda$是极点
7. 虚轴交点—临界稳定：$s=j\omega$（相应的，求阻尼比$\xi$为特定值的点，只要$s=A(\text{cos}\theta+j\text{sin}\theta)$即可）
8. （补充）当$n-m\ge2$时，开环极点之和=闭环极点之和

**非最小相位系统：**

把上面8条法则中的“奇数”全部换成“偶数”（2k+1换成2k）

**本题演示：**

![](\image\控制理论02.png)
$$
\begin{gather*}s=j\omega\Rightarrow-2j\omega^3+(1-10K)(-\omega^2)+9Kj\omega+K=0\\
\begin{cases}\omega^2(10K-1)+K=0\\9K\omega-2\omega^3=0 \end{cases}\\\Rightarrow K=\frac7{90}\Rightarrow K\le\frac7{90}
\end{gather*}
$$

### 奈氏图

奈奎斯特图、幅角原理与奈奎斯特稳定判据的**原理**：

1. 幅角原理：s平面上的闭合曲线C顺时针包围了Z个零点和P个极点，则其在F(s)平面上的映射将沿着原点顺时针旋转$N=Z-P$圈
2. 要判断是否稳定，需要找右半平面的点—>曲线C=虚轴+半径无限大右半平面半圆
3. 大半圆映射—>定点（无意义），虚轴映射—>奈奎斯特曲线恰好为极坐标图
4. 闭环极点与开环有区别—>看包围$(-1,j0)$的圈数
5. **当$Z=0$时系统稳定**，因此要求$Z=N+P=0$，即$N=-P$（逆时针旋转）

**本题演示：**

![](\image\控制理论03.png)
$$
\begin{gather*}G(j\omega)=\frac{K(1+28\omega^2)+jK\omega(7-20\omega^2)}{-\omega^2(1+4\omega^2)}（上下乘分母的共轭化为实数）
\\\varphi(\omega)=\text{atan}\frac{K\omega(7-20\omega^2)}{K(1+28\omega^2)}-\pi=\pi\Rightarrow\omega^2=\frac7{20}\\
\Rightarrow G(j\omega)=\frac{90K}7e^{j\pi}=-\frac{90K}7\ge -1\Rightarrow K\le\frac7{90}
\end{gather*}
$$

### 伯德图+余量

| Name     | 定义                                 | 频率伯德图                         | 判据                              |
| -------- | ------------------------------------ | ---------------------------------- | --------------------------------- |
| 相位裕量 | $\gamma=180°+\varphi(\omega_c)$      | 增益穿越频率$\omega_c$—零分贝点    | 相角$\varphi(\omega_c)>-180°$稳定 |
| 增益裕量 | $K_g=\frac1{|G(j\omega)H(j\omega)|}$ | 相位穿越频率$\omega_g$—相角-180°点 | 增益$L(\omega)<0$稳定             |

**本题演示：**（下图为临界稳定的伯德图）

![](\image\控制理论04.png)

* 用增益裕量的计算与上面奈氏图的计算式子几乎一样
* 用相位裕量的计算如下：（注：$1-s$相当于用$1+s$写，相位直接加π并反向）
  * 其斜率为：（-40)—(0.1)—>(-20)—(0.5)—>(-40)—(1)—>(-20)
  * 假设其在$\omega\in(0.5,1)$之间增益为0（这个肯定是要一步步假设的），计算$K=f(\omega)$，带入$\varphi(\omega)$使之等于0
  * md这题有点复杂我不太会算啊

## 控制系统的设计

### 系统的设计指标

​		事实上，这一小节的内容贯穿整个控制理论的课程，个人认为也是整个控制理论最重要的内容。

| 设计指标     | 时域指标                                                     | 频域指标                                                     |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **静态性能** | 静态误差：$e_{ss}$                                           | 静态误差系数：$K_{p,v,a}$                                    |
| **动态性能** | 时间：$t_p~,~t_s\propto\frac1{\omega_c}$<br />超调量：$\sigma_p\propto\frac1{\gamma}$ | 剪切频率：$\omega_c$<br />中频宽度：$h=\frac{\omega_3}{\omega_2}$ |
| **稳定性**   |                                                              | 相位裕量：$\gamma $ <br />幅值裕量：$K_g$                    |

* 个人的理解是，“稳定性”是独立于静态和动态性能的一个指标，是分析整个系统的前提（倘若不稳定，就没有后续分析的必要了）。如果硬要说是哪方面的话，还是感觉跟静态性能更接近一点（可以理解为如果系统不稳定，那么系统的静态性能为无穷差）。

* 闭环系统中：
  * 谐振峰值：$M_r=\frac{M_{max}}{M(0)}$，与最大超调量$\sigma_p$成正比，与时间量$t_r/t_s$成反比
  * 补充：$M_r=\frac{h+1}{h-1}=\frac1{\text{sin}\gamma }$

### 校正装置与频率法设计

#### 超前校正与滞后校正

|              | 超前校正                                                     | 滞后校正                                                     |
| ------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **表达式**   | $\frac{1+Ts}{1+\alpha Ts}=\frac1{\alpha}\frac{s+\frac1T}{s+\frac1{\alpha T}}$ | $\frac{1+Ts}{1+\beta Ts}=\frac1{\beta}\frac{s+\frac1T}{s+\frac1{\beta T}}$ |
| **稳态性能** | 不会改善系统的静态（稳态）性能                               | 改变开环增益，提升稳态性能                                   |
| **动态性能** | 通过增斜率，增相位裕量提升动态性能                           | 将斜率使剪切频率前移，降低动态性能                           |
| **原理**     | 1. 用中间**+20dB/dec**提穿越频率处的斜率<br />2. 用超前的相角提相位裕量，使$\omega_g$大幅后移 | 1. 新剪切频率$\omega_c'$处，用**-20dB**降幅值<br />2. 使剪切频率$\omega_c$大幅前移以提高相位裕量 |
| **原则**     | **剪切频率$\omega_c$近似不变，选在最大超前角的位置$\omega_m$** | **在新剪切频率$\omega_c'$处相角不变，幅值降20dB**            |
| **步骤**     | 1. 求所需补偿的最大超前角 $\phi_m=\gamma'-\gamma+\varepsilon$<br />2. 计算参数 $\text{sin}\phi_m=\frac{1-\alpha}{1+\alpha}\rightarrow\alpha=\frac{1-\text{sin}\phi_m}{1+\text{sin}\phi_m}$<br />3. 由**原则**：$20\text{lg}|G_0(j\omega_m)|=10\text{lg}\frac1{\alpha}$<br />4. 由3解得$\omega_m$并带入 $\omega_m=\frac1{\sqrt{\alpha}T}$ | 1. 由**原则**：$\varphi(\omega_c')=\gamma+\varepsilon-180°$<br />2. 由1解得$\omega_c'$并带入 $20\text{lg}|G(j\omega_c')|=20\text{lg}\beta$<br />3. 取 $\beta = \text{max}(10,\beta)$<br />4. 取 $\omega_2=\frac1T=\frac{\omega_c}{5\sim10}$ |

#### 滞后-超前校正

$$
G_c(s)=\frac{(T_1s+1)(T_2s+1)}{(\frac{T_1}{\beta}s+1)(\beta T_2s+1)}~;~\beta>1~,~T_2>T_1
$$

**原则：**（实际上就是一个PID控制器）

1. 用超前部分来增大系统的相位裕量，改善动态性能
2. 用滞后部分来改善系统的静态性能
3. 相位的滞后会带来不利影响，因此很显然滞后校正的转折频率要小于超前校正

**步骤：**

1. 求新的剪切频率 $\omega_c'$ 如下：

   1. 若题目要求快速性，则用题目给的 $\omega_c'$
   2. 若题目没有对此做出要求，解方程 $\varphi(\omega_c')=-180°$ ，作为新的剪切频率

2. **滞后校正**

   1. 见“原则3”：取 $\omega_2=\frac1T=\frac{\omega_c'}{10}$
   2. 在工程上一般选取 $\beta=10$ （见“滞后校正-步骤3”）

3. **超前校正**

   1. 考虑剪切频率处满足 $20\text{lg}|G(j\omega_c')|=0$，故计算 $20\text{lg}|G_c(j\omega_c')| =-20\text{lg}|G_0(j\omega_c)|=-K$

   2. 由下图：$20\times (\text{lg}\omega_c'-\text{lg}\omega_1)=20-K$

      ![](\image\控制理论08.jpg)

   3. 注：由于已经取了 $\beta=10$，因此两个转折频率满足十倍频的关系

4. 校验：若不满足，取 $\omega_c''<\omega_c'$，使相位裕量进一步增大

#### 校正装置的选取

1. 倘若系统稳定，稳态性能已经满足要求，相位裕量不够，那么就用超前校正
2. 倘若系统不稳定，如果用超前校正可能会使最大超前角$\phi_m$接近甚至大于90°，这是不可实现的，因此不稳定系统需要使用滞后校正
3. 有时使用单纯的滞后校正会使系统剪切频率 $\omega_c'$ 过小，快速性不满足要求，这个时候上滞后-超前校正

### 根轨迹法设计

#### 超前校正

​		不管是用哪一种方法，都遵循下面这一张图和一条最基本的原则公式：

![](\image\控制理论09.jpg)

​		在上图中，$s_d$是我们希望校正到的闭环极点，闭环极点满足**相角-180°，幅值为1**的条件。各点与$s_d$连线同正$x$轴的夹角之和就是相角，因此图中的$\phi$也表示校正系统提供给原系统的补偿角。**在任何一种情况下，都应该先计算补偿角。**因此有：
$$
\phi+\angle G_0(s_d)=-\pi
$$

|          | 零极点抵消法                                                 | 比值$\alpha$最大法                                           | 幅值确定法                                                   |
| -------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **条件** | 所希望的闭环主导极点$s_d$的正下方实轴上恰好有一开环极点      | 最方便，当其余两个条件都不满足时用这个                       | 当题目对稳态误差系数$K_{p,v,a}$有要求时用幅值确定法          |
| **例题** | p173 例6-6                                                   | p172 例6-5                                                   | p175 例6-7                                                   |
| **步骤** | 取 $\frac1T\approx p_i$，$p_i$为该正下方极点，如$p_i=1$可取$\frac1T=1.1,1.2,0.9$等 | 1. 套公式：$\gamma=\frac12(\pi-\theta-\phi)$<br />2. 需要额外计算闭环增益，以满足根轨迹的幅值条件 $|G(s_d)=1|$ | 1. 记：$u=\frac{|s_d^{\nu}|\sum|s_d+p_i|}{\sum|s_d+z_i|}$<br />2. 计算：$\text{cot} \gamma=\frac{u/k-\text{cos}\phi}{\text{sin}\phi}$ |

#### 滞后校正

这也太抽象了这个b滞后校正

* 原理：给予一对非常靠近原点的偶极子 $\frac1{\tau}和\frac1{\beta\tau}$ ，使主导极点基本不变，但是静态误差系数得以提高。步骤如下：
  1. 根据时域指标计算 $s_d$ 和增益K，并由此计算所需要放大的 $\beta$
  2. 以 $s_d$ 为原点将引线向左旋转5~10°，其与负实轴的交点就是零点 $-\frac1{\tau}$

### PID校正

$$
\begin{gather*} u(t)=K_P\left[ e(t)+\frac1{T_i}\int e(t)\text dt+T_d\frac{\text de(t)}{\text dt}\right]\\G_c(s)=K_P\left[ 1+\frac1{T_is}+\frac{T_ds}{1+s\frac{T_d}N} \right] \end{gather*}
$$

<table>
    <tr>
    	<th rowspan=2>比例环节</th><td>Kp↑</td><td>静态误差系数↑，静态性能↑</td>
    </tr>
    <tr>
    	<td>Kp↓</td><td>振荡↓，动态性能↑</td>
    </tr>
    <tr>
    	<th rowspan=2>积分环节</th><td>Ti↑(积分作用减弱)</td><td>响应变慢，静态性能↓</td>
    </tr>
    <tr>
    	<td>Ti↓(积分作用增加)</td><td>相位滞后，控制不及时，稳定性↓</td>
    </tr>
    <tr>
    	<th>微分环节</th><td>一般N>10</td><td>加快响应速度</td>
    </tr>
</table>

* Z-N整定公式：记 $\alpha=k\frac{\tau}T$，查表

### 极点配置法

​		题目希望引入一校正装置，使闭环系统的极点移动到指定位置。先设该校正装置的通式，带入求解，列方程。
