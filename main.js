document.addEventListener("DOMContentLoaded",()=>{let n,o,e=!1;const s=e=>{var t=e=>Array.from(e).reduce((e,t)=>e+t.offsetWidth,0),e=(e&&(e=t(document.querySelector("#blog-info > a").children),t=t(document.getElementById("menus").children),n=e+t,o=document.getElementById("nav")),window.innerWidth<=768||n>o.offsetWidth-120);o.classList.toggle("hide-menu",e)},l={open:()=>{btf.overflowPaddingR.add(),btf.animateIn(document.getElementById("menu-mask"),"to_show 0.5s"),document.getElementById("sidebar-menus").classList.add("open"),e=!0},close:()=>{btf.overflowPaddingR.remove(),btf.animateOut(document.getElementById("menu-mask"),"to_hide 0.5s"),document.getElementById("sidebar-menus").classList.remove("open"),e=!1}},t=()=>{var e=GLOBAL_CONFIG.highlight;if(e){const{highlightCopy:n,highlightLang:a,highlightHeightLimit:i,highlightFullpage:o,highlightMacStyle:s,plugin:l}=e;e=GLOBAL_CONFIG_SITE.isHighlightShrink;const r=n||a||void 0!==e||o||s;var t="highlight.js"===l?document.querySelectorAll("figure.highlight"):document.querySelectorAll('pre[class*="language-"]');if((r||i)&&t.length){const d="prismjs"===l,c=!0===e?"closed":"",g=void 0!==e?'<i class="fas fa-angle-down expand"></i>':"",m=n?'<div class="copy-notice"></div><i class="fas fa-paste copy-button"></i>':"",u=o?'<i class="fa-solid fa-up-right-and-down-left-from-center fullpage-button"></i>':"",f=(e,t)=>{void 0!==GLOBAL_CONFIG.Snackbar?btf.snackbarShow(t):(e.textContent=t,e.style.opacity=1,setTimeout(()=>{e.style.opacity=0},800))},h=(e,t)=>{var e=e.parentNode,n=(e.classList.add("copy-true"),d?"pre code":"table .code pre"),n=e.querySelector(n);n&&((async(e,t)=>{try{await navigator.clipboard.writeText(e),f(t,GLOBAL_CONFIG.copy.success)}catch(e){console.error("Failed to copy: ",e),f(t,GLOBAL_CONFIG.copy.noSupport)}})(n.innerText,t.previousElementSibling),e.classList.remove("copy-true"))},p=e=>e.classList.toggle("closed"),b=(e,t)=>{e=e.closest("figure.highlight").classList.toggle("code-fullpage");document.body.style.overflow=e?"hidden":"",t.classList.toggle("fa-down-left-and-up-right-to-center",e),t.classList.toggle("fa-up-right-and-down-left-from-center",!e)},L=e=>{var t=e.target.classList,n=e.currentTarget;t.contains("expand")?p(n):t.contains("copy-button")?h(n,e.target):t.contains("fullpage-button")&&b(n,e.target)},v=e=>e.currentTarget.classList.toggle("expand-done"),y=(e,t)=>{var n,a=document.createDocumentFragment();r&&((n=document.createElement("div")).className="highlight-tools "+c,n.innerHTML='<div class="macStyle"><div class="mac-close"></div><div class="mac-minimize"></div><div class="mac-maximize"></div></div>'+g+e+m+u,btf.addEventListenerPjax(n,"click",L),a.appendChild(n)),i&&(t=>{const n=new Map;{let e=t;for(;e!==document.body&&null!=e;)"none"===window.getComputedStyle(e).display&&n.set(e,e.getAttribute("style")||""),e=e.parentNode;const a="visibility: hidden !important; display: block !important;";n.forEach((e,t)=>{t.setAttribute("style",e?e+";"+a:a)})}t=t.offsetHeight;return n.forEach((e,t)=>{""===e?t.removeAttribute("style"):t.setAttribute("style",e)}),t})(t)>i+30&&((e=document.createElement("div")).className="code-expand-btn",e.innerHTML='<i class="fas fa-angle-double-down"></i>',btf.addEventListenerPjax(e,"click",v),a.appendChild(e)),d?t.parentNode.insertBefore(a,t):t.insertBefore(a,t.firstChild)};t.forEach(e=>{let t="";d&&btf.wrap(e,"figure",{class:"highlight"}),a?(d?t=e.getAttribute("data-language")||"Code":"plain"!==(t=e.getAttribute("class").split(" ")[1])&&void 0!==t||(t="Code"),y(`<div class="code-lang">${t}</div>`,e)):y("",e)})}}},a=()=>{GLOBAL_CONFIG.isPhotoFigcaption&&document.querySelectorAll("#article-container img").forEach(e=>{var t,n=e.title||e.alt;n&&((t=document.createElement("div")).className="img-alt text-center",t.textContent=n,e.insertAdjacentElement("afterend",t))})},i=()=>{btf.loadLightbox(document.querySelectorAll("#article-container img:not(.no-lightbox)"))},r=(o,a,e)=>{const{isButton:s,limit:l,firstLimit:i,tabs:r}=e;e=a.length;const d=Math.ceil((e-i)/l+1);const c=new InfiniteGrid.JustifiedInfiniteGrid(o,{gap:5,isConstantSize:!0,sizeRange:[150,600],useTransform:!0});let g=!1;const m=e=>e&&e.replace(/"/g,"&quot;")||"",u=e=>{var t=e.alt?`alt="${m(e.alt)}"`:"",n=e.title?`title="${m(e.title)}"`:"";return`<div class="item">
        <img src="${e.url}" data-grid-maintained-target="true" ${t} ${n} />
      </div>`},f=(e,t,n)=>{c.append(((e,t,n=!1)=>{n=n?(e-1)*t:(e-2)*t+i;return a.slice(n,n+t).map(u)})(e,t,n),e)},h=e=>{r&&(t=o.parentNode,g&&(t.style.visibility="visible"),0===o.offsetHeight)&&(t.style.visibility="hidden",g=!0);var{updated:t,isResize:e,mounted:n}=e;if(t.length&&n.length&&!e)if(btf.loadLightbox(o.querySelectorAll("img:not(.medium-zoom-image)")),c.getGroups().length===d)btf.setLoading.remove(o),r||c.off("renderComplete",h);else if(s){btf.setLoading.remove(o);{var a=o;const i=document.createElement("button");i.innerHTML=GLOBAL_CONFIG.infinitegrid.buttonText+'<i class="fa-solid fa-arrow-down"></i>',i.addEventListener("click",()=>{i.remove(),btf.setLoading.add(a),f(c.getGroups().length+1,l)},{once:!0}),a.insertAdjacentElement("afterend",i)}}},t=btf.debounce(e=>{e=(+e.groupKey||0)+1;1===e?f(e,i,!0):f(e,l),e===d&&c.off("requestAppend",t)},300);btf.setLoading.add(o),c.on("renderComplete",h),s?f(1,i,!0):(c.on("requestAppend",t),c.renderItems()),btf.addGlobalFn("pjaxSendOnce",()=>c.destroy())},d=async(o,s=!1)=>{var e;o.length&&(e=async()=>{for(const i of o)if(!btf.isHidden(i)&&!i.classList.contains("loaded")){var e={isButton:"true"===i.getAttribute("data-button"),limit:parseInt(i.getAttribute("data-limit"),10),firstLimit:parseInt(i.getAttribute("data-first"),10),tabs:s},t=i.firstElementChild,n=t.textContent;t.textContent="",i.classList.add("loaded");try{var a="url"===i.getAttribute("data-type")?await(async e=>{try{return await(await fetch(e)).json()}catch(e){return console.error("Failed to fetch URL:",e),[]}})(n):JSON.parse(n);r(t,a,e)}catch(e){console.error("Gallery data parsing failed:",e)}}},"function"!=typeof InfiniteGrid&&await btf.getScript(GLOBAL_CONFIG.infinitegrid.js),await e())},c=e=>{var e=btf.getScrollPercent(e,document.body),t=document.getElementById("go-up");e<95?(t.classList.add("show-percent"),t.querySelector(".scroll-percent").textContent=e):t.classList.remove("show-percent")},g=()=>{const i=document.getElementById("rightside"),e=window.innerHeight+56;let o=0;const s=document.getElementById("page-header"),l="undefined"!=typeof chatBtn,r=GLOBAL_CONFIG.percent.rightside,d=()=>document.body.scrollHeight<=e&&(i.classList.add("rightside-show"),!0);if(!d()){let a="";var t=btf.throttle(()=>{var e,t=window.scrollY||document.documentElement.scrollTop,n=(e=(n=t)>o,o=n,e);56<t?(""===a&&(s.classList.add("nav-fixed"),i.classList.add("rightside-show")),n?"down"!==a&&(s.classList.remove("nav-visible"),l&&window.chatBtn.hide(),a="down"):"up"!==a&&(s.classList.add("nav-visible"),l&&window.chatBtn.show(),a="up")):(a="",0===t&&s.classList.remove("nav-fixed","nav-visible"),i.classList.remove("rightside-show")),r&&c(t),d()},300);btf.addEventListenerPjax(window,"scroll",t,{passive:!0})}},m=()=>{const g=GLOBAL_CONFIG_SITE.isToc,m=GLOBAL_CONFIG.isAnchor,n=document.getElementById("article-container");if(n&&(g||m)){let s,l,r,t,d;if(g){const a=document.getElementById("card-toc");l=a.querySelector(".toc-content"),s=l.querySelectorAll(".toc-link"),t=a.querySelector(".toc-percentage"),d=l.classList.contains("is-expand");btf.addEventListenerPjax(l,"click",e=>{var t=e.target.closest(".toc-link");t&&(e.preventDefault(),btf.scrollToDest(btf.getEleTop(document.getElementById(decodeURI(t.getAttribute("href")).replace("#",""))),300),window.innerWidth<900)&&a.classList.remove("open")}),r=e=>{var t=l.clientHeight,n=e.offsetTop,e=e.clientHeight,a=l.scrollTop,n=n-a,t=(t-e)/2;n!=t&&(l.scrollTop=a+(n-t))},l.style.display="block"}const u=n.querySelectorAll("h1,h2,h3,h4,h5,h6");let c="";var e=btf.throttle(()=>{var e=window.scrollY||document.documentElement.scrollTop;g&&GLOBAL_CONFIG.percent.toc&&(t.textContent=btf.getScrollPercent(e,n));{var a=e;if(0!==a){let t="",n="";for(let e=0;e<u.length;e++){var i=u[e];if(!(a>btf.getEleTop(i)-80))break;i=i.id;t=i?"#"+encodeURI(i):"",n=e}if(c!==n&&(m&&btf.updateAnchor(t),c=n,g)&&(l.querySelectorAll(".active").forEach(e=>e.classList.remove("active")),t)){const o=s[n];if(o.classList.add("active"),setTimeout(()=>r(o),0),!d){let e=o.parentNode;for(;!e.matches(".toc");)e.matches("li")&&e.classList.add("active"),e=e.parentNode}}}}},100);btf.addEventListenerPjax(window,"scroll",e,{passive:!0})}},u=n=>{const a=(window.globalFn||{}).themeChange||{};a&&Object.keys(a).forEach(e=>{const t=a[e];["disqus","disqusjs"].includes(e)?setTimeout(()=>t(n),300):t(n)})},f={readmode:()=>{const e=document.body,t=document.createElement("button"),n=()=>{e.classList.remove("read-mode"),t.remove(),t.removeEventListener("click",n)};e.classList.add("read-mode"),t.type="button",t.className="fas fa-sign-out-alt exit-readmode",t.addEventListener("click",n),e.appendChild(t)},darkmode:()=>{var e="dark"===document.documentElement.getAttribute("data-theme")?"light":"dark";"dark"==e?(btf.activateDarkMode(),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(btf.activateLightMode(),void 0!==GLOBAL_CONFIG.Snackbar&&btf.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day)),btf.saveToLocal.set("theme",e,2),u(e)},"rightside-config":e=>{const t=e.firstElementChild;t.classList.contains("show")&&(t.classList.add("status"),setTimeout(()=>{t.classList.remove("status")},300)),t.classList.toggle("show")},"go-up":()=>{btf.scrollToDest(0,500)},"hide-aside-btn":()=>{var e=document.documentElement.classList,t=e.contains("hide-aside")?"show":"hide";btf.saveToLocal.set("aside-status",t,2),e.toggle("hide-aside")},"mobile-toc-button":(e,t)=>{const n=document.getElementById("card-toc");n.style.transition="transform 0.3s ease-in-out";var a=n.clientHeight,t=t.getBoundingClientRect(),i=window.innerHeight-t.bottom-30;i<a&&(n.style.transformOrigin=`right ${a-i-t.height/2}px`),n.classList.toggle("open"),n.addEventListener("transitionend",()=>{n.style.cssText=""},{once:!0})},"chat-btn":()=>{window.chatBtnFn()},translateLink:()=>{window.translateFn.translatePage()}},h=(document.getElementById("rightside").addEventListener("click",e=>{var t=e.target.closest("[id]");t&&f[t.id]&&f[t.id](e.currentTarget,t)}),()=>{var e=document.querySelectorAll("#article-container table");e.length&&e.forEach(e=>{e.closest(".highlight")||btf.wrap(e,"div",{class:"table-wrap"})})}),p=()=>{var e=document.querySelectorAll("#article-container .hide-button");e.length&&e.forEach(e=>e.addEventListener("click",e=>{e=e.currentTarget;e.classList.add("open"),d(e.nextElementSibling.querySelectorAll(".gallery-container"))},{once:!0}))},b=()=>{var e=document.querySelectorAll("#article-container .tabs");if(e.length){const i=(e,n)=>{e.forEach((e,t)=>{e.classList.toggle("active",t===n)})},n=e=>{var t,n,a=e.target.closest("button");a&&!a.classList.contains("active")&&(t=[...e.currentTarget.children],n=[...e.currentTarget.nextElementSibling.children],a=t.indexOf(a),i(t,a),e.currentTarget.classList.remove("no-default"),i(n,a),d(n[a].querySelectorAll(".gallery-container"),!0))};e.forEach(e=>{var t;btf.addEventListenerPjax(e.firstElementChild,"click",n),btf.addEventListenerPjax(e.lastElementChild,"click",(t=e,e=>{e.target.closest("button")&&btf.scrollToDest(btf.getEleTop(t),300)}))})}},L=e=>{e.forEach(e=>{e.textContent=btf.diffDate(e.getAttribute("datetime"),!0),e.style.display="inline"})};const v=()=>{t(),a(),d(document.querySelectorAll("#article-container .gallery-container")),i(),m(),h(),p(),b()};var y=()=>{var e,t,n,a,i;s(!0),o.classList.add("show"),(i=document.getElementById("recent-posts"))&&i.classList.contains("masonry")&&(i=()=>{const e=new InfiniteGrid.MasonryInfiniteGrid(".recent-post-items",{gap:{horizontal:10,vertical:20},useTransform:!0,useResizeObserver:!0});e.renderItems(),btf.addGlobalFn("pjaxCompleteOnce",()=>{e.destroy()},"removeJustifiedIndexPostUI")},"function"==typeof InfiniteGrid?i():btf.getScript(""+GLOBAL_CONFIG.infinitegrid.js).then(i)),"post"===GLOBAL_CONFIG_SITE.pageType?((i=document.getElementById("post-outdate-notice"))&&({limitDay:a,messagePrev:e,messageNext:t,postUpdate:n}=JSON.parse(i.getAttribute("data")),a<=(a=btf.diffDate(n)))&&(i.textContent=e+` ${a} `+t,i.hidden=!1),GLOBAL_CONFIG.relativeDate.post&&L(document.querySelectorAll("#post-meta time"))):(GLOBAL_CONFIG.relativeDate.homepage&&L(document.querySelectorAll("#recent-posts time")),GLOBAL_CONFIG.runtime&&(n=document.getElementById("runtimeshow"))&&(e=n.getAttribute("data-publishDate"),n.textContent=btf.diffDate(e)+" "+GLOBAL_CONFIG.runtime),(a=document.getElementById("last-push-date"))&&(t=a.getAttribute("data-lastPushDate"),a.textContent=btf.diffDate(t,!0)),(i=document.querySelector("#aside-cat-list.expandBtn"))&&btf.addEventListenerPjax(i,"click",e=>{var t=e.target;"I"===t.nodeName&&(e.preventDefault(),t.parentNode.classList.toggle("expand"))},!0)),"home"===GLOBAL_CONFIG_SITE.pageType&&(i=document.getElementById("scroll-down"))&&btf.addEventListenerPjax(i,"click",()=>{btf.scrollToDest(document.getElementById("content-inner").offsetTop,300)}),g(),v(),"shuoshuo"!==GLOBAL_CONFIG_SITE.pageType&&btf.switchComments(document),(i=document.getElementById("toggle-menu"))&&btf.addEventListenerPjax(i,"click",()=>{l.open()})},y=(btf.addGlobalFn("pjaxComplete",y,"refreshFn"),y(),window.addEventListener("resize",()=>{s(!1),e&&btf.isHidden(document.getElementById("toggle-menu"))&&l.close()}),document.getElementById("menu-mask"));if(y&&y.addEventListener("click",()=>{l.close()}),(y=document.querySelector("#sidebar-menus .menus_items"))&&y.addEventListener("click",e=>{e=e.target.closest(".site-page.group");e&&e.classList.toggle("hide")}),GLOBAL_CONFIG.islazyloadPlugin&&(window.lazyLoadInstance=new LazyLoad({elements_selector:"img",threshold:0,data_src:"lazy-src"}),btf.addGlobalFn("pjaxComplete",()=>{window.lazyLoadInstance.update()},"lazyload")),void 0!==GLOBAL_CONFIG.copyright){const{limitCount:w,languages:E}=GLOBAL_CONFIG.copyright;document.body.addEventListener("copy",e=>{e.preventDefault();var t=window.getSelection(0).toString();let n=t;return t.length>w&&(n=`${t}


${E.author}
${E.link}${window.location.href}
${E.source}
`+E.info),(e.clipboardData?e:window).clipboardData.setData("text",n)})}GLOBAL_CONFIG.autoDarkmode&&window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",e=>{void 0===btf.saveToLocal.get("theme")&&(e.matches?u("dark"):u("light"))}),window.addEventListener("hexo-blog-decrypt",e=>{v(),window.translateFn.translateInitialization(),Object.values(window.globalFn.encrypt).forEach(e=>{e()})})});